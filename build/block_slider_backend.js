!function(){"use strict";!function(){var e=window.wp.element;function t(){return t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a])}return e},t.apply(this,arguments)}var l=window.lodash;const{useDebounce:a,usePrevious:o}=wp.compose,{RawHTML:n,useEffect:r,useRef:s,useState:i}=wp.element,{__:__,sprintf:c}=wp.i18n,u=wp.apiFetch,{addQueryArgs:d}=wp.url,{Placeholder:p,Spinner:m}=wp.components,{getBlockType:h}=wp.blocks;function b(t){let{className:l}=t;return(0,e.createElement)(p,{className:l},__("Block rendered as empty."))}function g(t){let{response:l,className:a}=t;const o=c(// translators: %s: error message describing the problem
__("Error loading block: %s"),l.errorMsg);return(0,e.createElement)(p,{className:a},o)}function y(c){const{attributes:y,block:w,className:f,httpMethod:v="GET",urlQueryArgs:C,onChange:E,onError:k,EmptyResponsePlaceholder:S=b,ErrorResponsePlaceholder:T=g}=c,A=s(!0),N=s(),[F,O]=i(null),[_,B]=i(null),P=o(c);function x(){if(!A.current)return;null!==F&&(B(F),O(null));const e=y&&function(e,t){const a=h(e);if(void 0===a)throw new Error(`Block type '${e}' is not registered.`);return(0,l.reduce)(a.attributes,((e,l,a)=>{const o=t[a];return void 0!==o?e[a]=o:l.hasOwnProperty("default")&&(e[a]=l.default),-1!==["node","children"].indexOf(l.source)&&("string"==typeof e[a]?e[a]=[e[a]]:Array.isArray(e[a])||(e[a]=[])),e}),{})}(w,y),t="POST"===v,a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return d(`/wp/v2/block-renderer/${e}`,{context:"edit",...null!==t?{attributes:t}:{},...arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}})}(w,t?null:null!=e?e:null,C),o=t?{attributes:null!=e?e:null}:null,n=e=>A.current&&e===N.current;return N.current=u({path:a,data:o,method:t?"POST":"GET"}).then((e=>{n&&e&&O(e.rendered)})).then((()=>{E&&E()})).catch((e=>{n&&(O({error:!0,errorMsg:e.message}),k&&k(e))}))}const I=a(x,500);return r((()=>()=>{A.current=!1}),[]),r((()=>{void 0===P?x():(0,l.isEqual)(P.attributes,c.attributes)||I()})),""===F?(0,e.createElement)(S,c):F?F.error?(0,e.createElement)(T,t({response:F},c)):(0,e.createElement)(n,{className:f},F):_?(0,e.createElement)("div",{style:{position:"relative"}},(0,e.createElement)("div",{style:{position:"absolute",top:0,right:0}},(0,e.createElement)(m,null)),(0,e.createElement)(n,{className:f},_)):(0,e.createElement)(p,{className:f},(0,e.createElement)(m,null))}var w=JSON.parse('{"apiVersion":2,"name":"cumulus-gutenberg/testimonials-slider","title":"Testimonial Slider","description":"Display testimonials in a slider","category":"widgets","keywords":["testimonial","slider"],"icon":{"src":"slides","foreground":"#3399cc"},"supports":{"html":false,"anchor":true,"customClassName":false},"attributes":{"categories":{"type":"array","items":{"type":"object"},"default":[]},"tags":{"type":"array","items":{"type":"object"},"default":[]},"postsToShow":{"type":"number","default":0},"order":{"type":"string","default":"desc"},"orderBy":{"type":"string","default":"rand"},"showContent":{"type":"string","default":"full"},"showLogo":{"type":"boolean","default":true},"showCustomerName":{"type":"boolean","default":true},"showCustomerTitle":{"type":"boolean","default":true},"showCompany":{"type":"boolean","default":true},"slidesToShow":{"type":"number","default":1},"slidesToScroll":{"type":"number","default":1},"autoplay":{"type":"boolean","default":true},"autoplaySpeed":{"type":"number","default":8},"transitionSpeed":{"type":"number","default":0.5},"showArrows":{"type":"boolean","default":true},"showDots":{"type":"boolean","default":true},"animationType":{"type":"string","default":"slide"},"verticalAlign":{"type":"string","default":"center"}},"editorScript":"file:../../../build/block_slider_backend.js","editorStyle":"file:../../../build/block_slider_backend.css"}');const{registerBlockType:f}=wp.blocks,{Panel:v,PanelBody:C,RangeControl:E,FormTokenField:k,SelectControl:S,ToggleControl:T,TextControl:A}=wp.components,N=wp.apiFetch,{addQueryArgs:F}=wp.url,{InspectorControls:O,BlockControls:_,useBlockProps:B,BlockVerticalAlignmentToolbar:P}=wp.blockEditor,{useState:x,useEffect:I,useRef:R}=wp.element;f(w.name,{...w,edit:t=>{const{attributes:a,setAttributes:o}=t,[n,r]=x([]),[s,i]=x([]),[c,u]=x([]),[d,p]=x([]),m=e=>"object"==typeof e?e.reduce(((e,t)=>({...e,[t.name]:t})),{}):{},h=m(n),b=m(c),g=(e,t,l)=>{if(t){if(t.some((e=>"string"==typeof e&&!l[e])))return;const a=t.map((e=>"string"==typeof e?l[e]:e));if(a.includes(null))return!1;o({[e]:a})}},f=R();let j;const D=e=>{let t,l,a;switch(f.current=!0,e){case"categories":t="/wp/v2/cmls_testimonial-category",l=s,a=r;break;case"tags":t="/wp/v2/cmls_testimonial-tags",l=d,a=u}if(t){const e=j=N({path:F(t,{per_page:-1,search:l})}).then((t=>{f.current&&e===j&&a(t)})).catch((()=>{f.current&&e===j&&a([])}))}return()=>{f.current=!1}};I((()=>D("categories")),[s]),I((()=>D("tags")),[d]);const M=B();return(0,e.createElement)("div",M,(0,e.createElement)(O,null,(0,e.createElement)(v,null,(0,e.createElement)(C,{title:"Query Controls"},(0,e.createElement)(S,{label:"Order By",value:a.orderBy+"/"+a.order,onChange:e=>{const t=e.split("/");o({orderBy:t[0],order:t[1]})},options:[{value:"rand/asc",label:"Random"},{value:"date/desc",label:"Newest to oldest"},{value:"date/asc",label:"Oldest to newest"},{value:"post_title/asc",label:"Title A → Z"},{value:"post_title/desc",label:"Title Z → A"},{value:"menu_order/asc",label:"Manual Order Field (Ascending)"},{value:"menu_order/desc",label:"Manual Order Field (Descending)"}]}),(0,e.createElement)(k,{label:"Categories",placeholder:"Choose from existing categories.",value:a.categories&&a.categories.map((e=>e.name)),suggestions:Object.keys(h),onChange:e=>g("categories",e,h),onInputChange:(0,l.debounce)((e=>i(e)),300)}),(0,e.createElement)(k,{label:"Tags",placeholder:"Choose from existing tags.",value:a.tags&&a.tags.map((e=>e.name)),suggestions:Object.keys(b),onChange:e=>g("tags",e,b),onInputChange:(0,l.debounce)((e=>p(e)),300)}),(0,e.createElement)(E,{label:"Number of Testimonials to display",help:"Choose 0 to fetch all.",allowReset:!0,resetFallbackValue:0,step:1,withInputField:!0,marks:[{value:0,label:"All"},{value:50,label:"50"}],value:a.postsToShow,onChange:e=>o({postsToShow:null!==e?parseInt(e,10):0}),min:0,max:50})),(0,e.createElement)(C,{title:"Content Display",initialOpen:!1},(0,e.createElement)(S,{label:"Show Content",value:a.showContent,onChange:e=>o({showContent:e}),options:[{value:"full",label:"Full"},{value:"excerpt",label:"Excerpt"},{value:"none",label:"None"}]}),(0,e.createElement)(T,{label:"Show Customer Name",checked:a.showCustomerName,onChange:e=>o({showCustomerName:e})}),(0,e.createElement)(T,{label:"Show Customer Title",checked:a.showCustomerTitle,onChange:e=>o({showCustomerTitle:e})}),(0,e.createElement)(T,{label:"Show Company",checked:a.showCompany,onChange:e=>o({showCompany:e})}),(0,e.createElement)(T,{label:"Show Logo",checked:a.showLogo,onChange:e=>o({showLogo:e})})),(0,e.createElement)(C,{title:"Slider Options",initialOpen:!1},(0,e.createElement)(S,{label:"Animation Type",value:a.animationType,onChange:e=>o({animationType:e}),options:[{value:"slide",label:"Slide"},{value:"fade",label:"Fade"}]}),(0,e.createElement)(T,{label:"Show Arrows",checked:a.showArrows,onChange:e=>o({showArrows:e})}),(0,e.createElement)(T,{label:"Show Dots",checked:a.showDots,onChange:e=>o({showDots:e})}),(0,e.createElement)(E,{label:"Number of slides to show at once",allowReset:!0,resetFallbackValue:1,step:1,withInputField:!0,marks:[{value:1,label:"1"},{value:5,label:"5"}],value:a.slidesToShow,onChange:e=>o({slidesToShow:e?parseInt(e,10):1}),min:1,max:5}),(0,e.createElement)(E,{label:"Number of slides to move at once",allowReset:!0,resetFallbackValue:1,step:1,withInputField:!0,marks:[{value:1,label:"1"},{value:5,label:"5"}],value:a.slidesToScroll,onChange:e=>o({slidesToScroll:e?parseInt(e,10):1}),min:1,max:5}),(0,e.createElement)(T,{label:"Autoplay",checked:a.autoplay,onChange:e=>o({autoplay:e})}),a.autoplay&&(0,e.createElement)(A,{label:"Autoplay speed (in seconds)",type:"number",value:parseFloat(a.autoplaySpeed),onChange:e=>o({autoplaySpeed:e||0===e?parseFloat(e):0})}),(0,e.createElement)(A,{label:"Transition speed (in seconds)",type:"number",value:parseFloat(a.transitionSpeed),onChange:e=>o({transitionSpeed:e||0===e?parseFloat(e):0})})))),(0,e.createElement)(_,null,(0,e.createElement)(P,{value:a.verticalAlign,onChange:e=>{o({verticalAlign:e})}})),(0,e.createElement)(y,{block:w.name,attributes:a,httpMethod:"POST",onChange:()=>{const e=document.querySelector(`#block-${t.clientId} .splide`);e&&(e.splide&&e.splide.destroy(!0),e.splide=new Splide(e).mount())}}))}})}()}();